<div class="campaign-list" ng-controller="core/campaigns/ListDisplayCampaignsController">
  <div class="campaign-list-content">
    <div class="campaign-list-heading">
      <h1>
        Display Campaigns
        <button type="button" class="mics-btn mics-btn-action btn-xs" ng-click="refresh()">
          <span class="glyphicon glyphicon-refresh"></span>Refresh
        </button>
      </h1>
    </div>

    <div class="campaign-list-controller mics-table-toolbar">
      <!-- New Campaign Button -->
      <div class="col-md-6">
        <div class="campaign-list-actions" uib-dropdown>
          <button class="mics-btn mics-btn-add" uib-dropdown-toggle type="button">New Campaign</button>
          <ul class="dropdown-menu" role="menu">
            <li role="presentation" ng-repeat="editor in campaignEditors">
              <a role="menuitem" tabindex="-1" ng-click="create(editor)">
                {{editor.name}}
              </a>
            </li>
          </ul>
        </div>
      </div>
      <!-- Date picker -->
      <div class="col-md-6">
        <div class="campaign-list-date-controller pull-right">
          <span ng-show="statisticsQuery.isRunning || exportQuery.isRunning">
             <img src="./images/ajax-loader.gif" alt="computing..." class="inline-ajax-loader">
          </span>
          <form class="form-inline pull-right" role="form">
            <input type="daterange" ng-model="reportDateRange" class="form-control range" format="L" ranges="reportDefaultDateRanges" opens="'left'">
          </form>
          <div class="dropdown pull-right" uib-dropdown>
            <button class="btn btn-default" uib-dropdown-toggle type="button">Export <span class="caret"></span></button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="Choose Export Format">
              <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="export('xlsx')">Excel (.xlsx)</a></li>
              <!--<li role="presentation"><a role="menuitem" tabindex="-1" ng-click="export('csv')">CSV</a></li>-->
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="campaign-list-area" ng-show="displayCampaigns.length">
      <table class="campaign-list-table table-hover js-auto-hide-actions">
        <thead>
        <tr>
          <th class="status">Status</th>
          <th>Name</th>
          <th ng-if="administrator">Organisation</th>
          <th class="metrics" ng-repeat="metric in displayCampaignsStatistics.getMetrics()">
            {{displayCampaignsStatistics.getMetricName(metric) }}
          </th>
          <th class="actions">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="campaign in displayCampaigns | orderBy: ['status', 'name'] | offset: (currentPageDisplayCampaign - 1)*itemsPerPage | limitTo: itemsPerPage">
          <td><div mics-campaign-status="campaign"></div></td>
          <td class="clickable-box"><a ng-href="#{{getCampaignDashboardUrl(campaign)}}">{{campaign.name}}</a></td>
          <td class="clickable-box" ng-if="administrator">
            <a ng-href="#{{getCampaignDashboardUrl(campaign)}}">{{organisationName(campaign.organisation_id)}}</a>
          </td>
          <td class="metrics clickable-box" ng-repeat="metricValue in displayCampaignsStatistics.getRow(campaign.id) track by $index">
            <a  ng-href="#{{getCampaignDashboardUrl(campaign)}}">
              <span ng-if="metricValue.type == 'currency'">{{metricValue.value | number:2 | currencyWithSymbol:campaign.currency_code}}</span>
              <span ng-if="metricValue.type == 'percent'">{{metricValue.value | number}} %</span>
              <span ng-if="metricValue.type == 'number'">{{metricValue.value | number}}</span>
              <span ng-if="!metricValue.type">-</span>
            </a>
          </td>
          <td class="actions">
            <a class="mics-btn mics-btn-action" ng-href="#{{getCampaignDashboardUrl(campaign)}}">Show Details</a>
            <a class="mics-btn mics-btn-action" ng-click="editCampaign(campaign, $event)">Edit</a>
            <a class="mics-btn mics-btn-delete" ng-click="deleteCampaign(campaign, $event)">Delete</a>
          </td>
        </tr>
        </tbody>
      </table>
      <uib-pagination total-items="displayCampaigns.length" ng-model="currentPageDisplayCampaign" items-per-page="itemsPerPage"></uib-pagination>
    </div>

  </div>
</div>
